<?php

namespace Bigprimes\Pages;

class Cruncher extends \Bigprimes\Pages
{
    private $max_len_prime               = 11;
    private $max_len_cube                = 17;
    private $max_len_square              = 19;
    private $max_len_triangle            = 17;
    private $max_len_convertion          = 500; //converting the number to binary and hex ...
    private $max_len_factorization       = 9;
    private $max_len_roman_numerals      = 6;
    private $max_len_egypt_numerals      = 7;
    private $max_len_chinese_numerals    = 6;
    private $max_len_babylonian_numerals = 13;
    // fermat numbers array
    private $array_fermat                = ['3', '5', '17', '257', '65537', '4294967297',
        '18446744073709551617', '340282366920938463463374607431768211457',
        '115792089237316195423570985008687907853269984665640564039457584007913129639937',
        '13407807929942597099574024998205846127479365820592393377723561443721764030073546976801874298166903427690031858186486050853753882811946569946433649006084097'];
    //mersenne primes array
    private $array_mersenne              = [
        '3'
        , '7'
        , '31'
        , '127'
        , '8191'
        , '131071'
        , '524287'
        , '2147483647'
        , '2305843009213693951'
        , '618970019642690137449562111'
        , '162259276829213363391578010288127'
        , '170141183460469231731687303715884105727'
        , '6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151'
        , '531137992816767098689588206552468627329593117727031923199444138200403559860852242739162502265229285668889329486246501015346579337652707239409519978766587351943831270835393219031728127'
        , '10407932194664399081925240327364085538615262247266704805319112350403608059673360298012239441732324184842421613954281007791383566248323464908139906605677320762924129509389220345773183349661583550472959420547689811211693677147548478866962501384438260291732348885311160828538416585028255604666224831890918801847068222203140521026698435488732958028878050869736186900714720710555703168729087'
        , '1475979915214180235084898622737381736312066145333169775147771216478570297878078949377407337049389289382748507531496480477281264838760259191814463365330269540496961201113430156902396093989090226259326935025281409614983499388222831448598601834318536230923772641390209490231836446899608210795482963763094236630945410832793769905399982457186322944729636418890623372171723742105636440368218459649632948538696905872650486914434637457507280441823676813517852099348660847172579408422316678097670224011990280170474894487426924742108823536808485072502240519452587542875349976558572670229633962575212637477897785501552646522609988869914013540483809865681250419497686697771007'
        , '446087557183758429571151706402101809886208632412859901111991219963404685792820473369112545269003989026153245931124316702395758705693679364790903497461147071065254193353938124978226307947312410798874869040070279328428810311754844108094878252494866760969586998128982645877596028979171536962503068429617331702184750324583009171832104916050157628886606372145501702225925125224076829605427173573964812995250569412480720738476855293681666712844831190877620606786663862190240118570736831901886479225810414714078935386562497968178729127629594924411960961386713946279899275006954917139758796061223803393537381034666494402951052059047968693255388647930440925104186817009640171764133172418132836351'
        , '259117086013202627776246767922441530941818887553125427303974923161874019266586362086201209516800483406550695241733194177441689509238807017410377709597512042313066624082916353517952311186154862265604547691127595848775610568757931191017711408826252153849035830401185072116424747461823031471398340229288074545677907941037288235820705892351068433882986888616658650280927692080339605869308790500409503709875902119018371991620994002568935113136548829739112656797303241986517250116412703509705427773477972349821676443446668383119322540099648994051790241624056519054483690809616061625743042361721863339415852426431208737266591962061753535748892894599629195183082621860853400937932839420261866586142503251450773096274235376822938649407127700846077124211823080804139298087057504713825264571448379371125032081826126566649084251699453951887789613650248405739378594599444335231188280123660406262468609212150349937584782292237144339628858485938215738821232393687046160677362909315071'
        , '190797007524439073807468042969529173669356994749940177394741882673528979787005053706368049835514900244303495954950709725762186311224148828811920216904542206960744666169364221195289538436845390250168663932838805192055137154390912666527533007309292687539092257043362517857366624699975402375462954490293259233303137330643531556539739921926201438606439020075174723029056838272505051571967594608350063404495977660656269020823960825567012344189908927956646011998057988548630107637380993519826582389781888135705408653045219655801758081251164080554609057468028203308718724654081055323215860189611391296030471108443146745671967766308925858547271507311563765171008318248647110097614890313562856541784154881743146033909602737947385055355960331855614540900081456378659068370317267696980001187750995491090350108417050917991562167972281070161305972518044872048331306383715094854938415738549894606070722584737978176686422134354526989443028353644037187375385397838259511833166416134323695660367676897722287918773420968982326089026150031515424165462111337527431154890666327374921446276833564519776797633875503548665093914556482031482248883127023777039667707976559857333357013727342079099064400455741830654320379350833236245819348824064783585692924881021978332974949906122664421376034687815350484991'
        , '285542542228279613901563566102164008326164238644702889199247456602284400390600653875954571505539843239754513915896150297878399377056071435169747221107988791198200988477531339214282772016059009904586686254989084815735422480409022344297588352526004383890632616124076317387416881148592486188361873904175783145696016919574390765598280188599035578448591077683677175520434074287726578006266759615970759521327828555662781678385691581844436444812511562428136742490459363212810180276096088111401003377570363545725120924073646921576797146199387619296560302680261790118132925012323046444438622308877924609373773012481681672424493674474488537770155783006880852648161513067144814790288366664062257274665275787127374649231096375001170901890786263324619578795731425693805073056119677580338084333381987500902968831935913095269821311141322393356490178488728982288156282600813831296143663845945431144043753821542871277745606447858564159213328443580206422714694913091762716447041689678070096773590429808909616750452927258000843500344831628297089902728649981994387647234574276263729694848304750917174186181130688518792748622612293341368928056634384466646326572476167275660839105650528975713899320211121495795311427946254553305387067821067601768750977866100460014602138408448021225053689054793742003095722096732954750721718115531871310231057902608580607'
        , '4782202788054612029528392986600059097414971724022365008513345109918378950942662970278927686112707894586824720981524256319306585052676834087480834429433264797425893247623688331021633208954847354805799943341309825989013743806187109581043148680813778321530496715601563282624414040398143207622036272190408590790537203475256105564071579263867875240985573356522656108542128577321057879052328865035355873615679363655889925711574420153832091752422843046918811427400662135559303516853703976812686385750376227787949580582081831261725701003498206512329872677233489510953469375683037038373999696771585788905639115522613405495707184524158219208223766442059014593330657009722153962376853423770486138578089775621301167811299166407361746606697808186757966914671246073712904200588408923186387737887675292886953797066980967406053530122853539036965490224784924649007954898678503314655546475504501686187354866964374552614120640782949622452027788962138602665933147687696322089504278791624651519312327831756553779377194524673395819281486668576384019590720179413349582970319393884388810494546040342087536563628332152073181614300721769371426238517540520845214665313301183551962591849558938499025348780376716477073930634436840084468255937443451690315999349137664638968972614199015304906547819056227171224947070739716300953775743441307920501863532234466545645695774331885044978250148663467372130392099894852145190998232878772486650513010816769902892518719250066947215706536216248696240569256865554296221552211560427778662545936998801070186162601476474293459830183651273363462732675883060701410359254829149774339297173680765610959599911309189788238350131635672661435969218239977196933874395403996623675580528211207136396370858056051160781770985452576988032333812939272752101944629527490313835551985197095928885236415301789218675141014541203096191270934369039522098280317668942061325572349643638403056487349290884223786292887472231219032385281034091824306618947740727265524284893304474861454942076799041739447165838281671410435831206790501914527326287370339974707206016882562827404270170322606727980343479326425730091839813077719322455394763960606588214326603156141490740557698055166263044447583756711516490181193442236859424151843795389335765432129944054855345155859273424561825146813714720606287781021240923708021492298349635179527270302962970156927686511635050080407282674252362644695710769768866137302789313609674382719017385508484663373476120843567983065059558072935110637544240807350667082987233779768874938983584523095638996120616318634391967112086464384649470963230072729200912586147267999762496709852769503535733924416202657720741248683592202828983311140833923302433917797976990311425843619350936754483811194408812763388084204451804912454383884180800945275626668057628954763384641305107753773247082495804533355717481965025070819730466422826105697510564289798951182192885976352229053898948737614642139910911535864505818992696826225754111'
        , '34608828249085121524296039576741331672262866890023854779048928344500622080983411446436437554415370753366448674763505018641470709332373970608376690404229265789647993709760358469552319045484910050304149809818540283507159683562232941968059762281334544739720849260904855192770626054911793590389060795981163838721432994278763633095377438194844866471124967685798888172212033000821469684464956146997194126921284336206463313859537577200462442029064681326087558257488470489384243989270236884978643063093004422939603370010546595386302009073043944482202559097406700597330570799507832963130938739885080198416258635194522913042562936679859587495721031173747796418895060701941717506001937152430032363631934265798516236047451209089864707430780362298307038193445486493756647991804258775574973833903315735082891029392359352758617185019942554834671861074548772439880729606244911940066680112823824095816458261761861746604034802056466823143718255492784779380991749580255263323326536457743894150848953969902818530057870876229329803338285735419228259022169602665532210834789602051686546011466737981306056247480055071718250333737502267307344178512950738594330684340802698228963986562732597175372087295649072830289749771358330867951508710859216743218522918811670637448496498549094430541277444079407989539857469452772132166580885754360477408842913327292948696897496141614919739845432835894324473601387609643750514699215032683744527071718684091832170948369396280061184593746143589068811190253101873595319156107319196071150598488070027088705842749605203063194191166922106176157609367241948160625989032127984748081075324382632093913796444665700601391278360323002267434295194325607280661260119378719405151497555187549252134264394645963853964913309697776533329401822158003182889278072368602128982710306618115118964131893657845400296860012420391376964670183983594954112484565597312460737798777092071706710824503707457220155015899591766244957768006802482976673920392995410164224776445671222149803657927708412925555542817045572430846389988129960519227313987291200902060882060733762075892299473666405897427035811786879875694315078654420055603469625309399653955932310466430039146465805452965014040019423897552675534768248624631951431493188170905972588780111850281190559073677771187432814088678674286302108275149258477101296451833651979717375170900505673645964696355331369819296000267389583289299126738345726980325998955997501176664201042888546085699446442834195232948787488410595750197438786353119204210855804692460582533832967771946911459901921324984968810021189968284941331573164056304725480868921823442538199590383852412786840833479611419970101792978355653650755329138298654246225346827207503606740745956958127383748717825918527473164970582095181312905519242710280573023145554793628499010509296055849712377978984921839997037415897674154830708629145484724536724572622450131479992681684310464449439022250504859250834761894788889552527898400988196200014868575640233136509145628127191354858275083907891469979019426224883789463551'
    ];
    // perfect numbers array
    private $array_perfect               = ['6'
        , '28'
        , '496'
        , '8128'
        , '33550336'
        , '8589869056'
        , '137438691328'
        , '2305843008139952128'
        , '2658455991569831744654692615953842176'
        , 191561942608236107294793378084303638130997321548169216
        , '13164036458569648337239753460458722910223472318386943117783728128'
        , '14474011154664524427946373126085988481573677491474835889066354349131199152128'
        , '23562723457267347065789548996709904988477547858392600710143027597506337283178622239730365539602600561360255566462503270175052892578043215543382498428777152427010394496918664028644534128033831439790236838624033171435922356643219703101720713163527487298747400647801939587165936401087419375649057918549492160555646976'
        , '141053783706712069063207958086063189881486743514715667838838675999954867742652380114104193329037690251561950568709829327164087724366370087116731268159313652487450652439805877296207297446723295166658228846926807786652870188920867879451478364569313922060370695064736073572378695176473055266826253284886383715072974324463835300053138429460296575143368065570759537328128'
        , '54162526284365847412654465374391316140856490539031695784603920818387206994158534859198999921056719921919057390080263646159280013827605439746262788903057303445505827028395139475207769044924431494861729435113126280837904930462740681717960465867348720992572190569465545299629919823431031092624244463547789635441481391719816441605586788092147886677321398756661624714551726964302217554281784254817319611951659855553573937788923405146222324506715979193757372820860878214322052227584537552897476256179395176624426314480313446935085203657584798247536021172880403783048602873621259313789994900336673941503747224966984028240806042108690077670395259231894666273615212775603535764707952250173858305171028603021234896647851363949928904973292145107505979911456221519899345764984291328'
        , '1089258355057829337698225273522048981957108454302608067318906618508470155298616996291940961858901379546182685531220055762780759342407499066046704182083087124626926378164410931450968826355205573671671624202686633360807123109470452668371537599662797484934359039779954213666598820299501366380164619080260403235229556730554163992303009752651350320619930563673695280153023049498468696618144072021372831425963701460505606378119245841386552600145384072983309717141950085498085709671387054868320477972299055273914798446936214147860706887052107312380067072602317009422809314774791894700769891009818743169303028154303290071199392984292940283852217800166629229157110264080599294016452483028528153331119523441423159614934140265550242360007858215936798489500727196347516386044241721984706558329364277995903102292034620628080752342422906401283027034649671445569324281946859622177566643375489715678451311792675935981010355562887971948569016060035334607879359770371846507659970601616998311983878150420763306289490886429900481786499537645379839365212725494441511932772182768149943659849007457246983861558265144823191367758350341527780770221556945275566504831636564856831502556078058133043400055653540413313266034639355202834006126905491569560542489551023207382276137352665717018261519604817417112576526410535323991500058749996247580834453782528'
        , '99497054337086473442435202604522816989643863571126408511774020575773849326355529178686629498151336416502516645641699516813140394897940636561646545947753232301453603583223268085613647233768081645727669037394385696522820301535888041815559513408036145123870584325525813950487109647770743827362571822870567643040184723115825645590386313377067112638149253171843914780065137373446222406322953569124771480101363180966448099882292453452395428270875732536311539266115116490704940164192417744919250000894727407937229829300578253427884494358459949535231819781361449649779252948099909821642207485514805768288115583409148969875790523961878753124972681179944234641016960011815788847436610192704551637034472552319820336532014561412028820492176940418377074274389149924303484945446105121267538061583299291707972378807395016030765440655601759109370564522647989156121804273012266011783451102230081380401951383582987149578229940818181514046314819313206321375973336785023565443101305633127610230549588655605951332351485641757542611227108073263889434409595976835137412187025349639504404061654653755349162680629290551644153382760681862294677414989047491922795707210920437811136712794483496437355980833463329592838140157803182055197821702739206310971006260383262542900044072533196137796552746439051760940430082375641150129817960183028081010978780902441733680977714813543438752546136375675139915776'
        , '33570832131986724437010877211080384841138028499879725454996241573482158450444042882048778809437690388449535774260849885573694759906173841157438424730130807047623655942236174850509108537827658590642325482494761473196579074656099918600764404702181660294469121778737965822199901663478093006075022359223201849985636144177185925402078185073015045097727084859464743635537781500284915880244886306461785982956072060013474955617851481680185988557136609224841817877083608951191123174885226416130683197710667392351007374503755403352531476227943590071651702697594241031955529898971218001214641774673134944471562560957179657881556419122102935450299751813340515170956167951095453649485576150660101689160658011770193274226308280507786835049549112576654510119670456745939890194205255175384484489909328967646988163155982471564998196261632751283127879509198074253193409580454562488664383465379885002735506153988851506645137759275553988219425439764732399824712438125054117523837438256744437055019441051006489972341609117978404563794992004873057518455748701444951238377139620494287982489529827233140637014837408856156199515457669607964052126908149265601786094447595560440059050091763547114092255371397425807867554352112542194784815494784276201170845949274674632985210421075531784918358926690395463649721452265405713484388043911634485432358638806645313826206591131266232422007835577345584225720310518698143376736219283021119287617896146885584860065048876315701088796219593640826311622273328035603309475642390804499460156797855361018246696101253922254567240908315385468240931846166962495983407607141601251889544407008815874744654769507268678051757746956891212485456261121386667407711139619071530923355823178662705374393035049022603882479742334799407130280148769298597743778193050348749740786928096033906295910199238181338557856978191860647256209708168229116156300978059197026855726877649767072684960463452763160384093838292277544911857859658328888332628525056'
        , '18201749040140430273835167914751015293362889506937596103357359437740048438463485836303232258902400875568993809975036246337556768238366233707757573415903278080066115951092522543145952013119010340408099881835975590975835499003463227280543140756802691525621894771543951403656868707748606069885095036335283528581813088651653833089052785834280723280067200484903706704970113521040604064538274154252165373175595605248628998615687866235395077520314640188634353318831397392517095413127961059169783805545093120277974213161792712750189234973622853507624924636687588461310469170436099238232492598937308477793932361698480685664770932715430491007662682405163044765107996164343261202355969912750334459238591875176292279879181327972920090211444842306766331109269166235125509668704478958734853068636529397153443016761158813447481567868262367893981171020212189792514086148090215189947704212407282687964267041783873543080261582448824858431838554183153705837057341487700727731550997896239330477471263230726484877117521254868468174015562068490713644719481693089433418532636835808942200716440819313366362403191355576523173825131875335647759016207232990842875902548737480801898289658229210850221695663421649611729577245208490877897945867171915873804061345544603919338281884397538634259920738193259330950837923823615411304543599290641330796754637229721314074245135865275394292301532835414540035740253567232435673868968242806554916467387945199026147468808031055150281915733287931898181708779241724409277593094799901224641825850183281480975988801751016901958988814849430087926938683408662084176896164178170688871544229415824450055526787148715365214142372692896788902761679810950828268208180845309986581369910322372338718437892376924042425319226250711104694125177110946650435829229609212441927473293781744486775943173110295432226780186422343937384580708855852269417012387614583884866613236875101300845603785945237925447338784922452682337026775686191693583794243538309813874806083439394116832472101884074936138517168612519077402832074575032255369216417037979614393919019507244388546924316787128440250098924928769352393698587810869831127888084696751795845351130410199628821737636610886633120714458623846784948362409208330416268144841565505869827619451490634144640754203543507421045031995754480556197763855213987476437990952173006055503017305481394836591954388794314558786433824434673257753459825605748638411145315395326160048592155490496363095590187403880545069860151237473584639382355987779291886392614452838326884468500853448420623482240841078202705004101172745586672975106848437133377536'
        , '11434731753038652271870510502563054290369839984534725895332249364908334961882164947674351989064116525342087095396782955614598901690359527368200306791037330859857972857435008419908682920845277220892386034162964072635709694931769479876248750202202966413347062605501560591838954155776739969243412686516039219207531547575533505784997468578047154815673455144291529551460592270962534531406165620944440834496909183933479177056134394989991079872495003112497387572982253655871642841276259997777969281650961184963681165156135030716133286358236790904294805085996539450440397259321779367404437324097409473827763050662988434475431439487893781464232206686643397789899506730271620505444721680758712995051366001609878486401756427622203061515536013038628113933285137794681656964917604398533820705074441564282611795522268562186704703666450026589020021088118208856495629918319917323246502646278589671096849425171744978412686617422702072318303876067532120552307086861404163620773329817538718438960094624691381751716824755508230593661091142583022460070488652758870749893562067416666683134710937562255888939283852449848883083949426685416747561615736871070322397677554824168698122415887624044491081523702163186214860670963974843434990150580336061361128446317947836395002812389227258535979589116682994095790818840141392100002121484746263398298269011568647849919325130179957764082742812086707435289888867996546182996334309106553241262702950865875890258826346579702381381532554959190921932580283034694452612563595237410148597510276295301661021465685367517269929486554251331056986921264847284801220356787886271451144575296681731210806262017773614658565355556304203525721218368092716803784696369604175605428669596483152723251207753030716796392719600906670836303595493470714193198199178512164466800911266395980327226741775067834142804538996505567385849212224049038933494413385316694249093117679932317175631713976414497786785387930339300514992922213670421059098550054655566738564333812948431411916586171122495203548154239947807358729100981341449364010936920913641239353666202161372565303868912597733470916773974659066920874581905740253737958111365707416415231569912388895514146043465350761210218323219258114752999284649256433615427727357746247521167973626920033206422419756880299734859922106610249531345645354898619984932287573732778253405930614511563461083563246421004359764227776138493737491924858971325462356870894436832415652563472219886604579549816794943137016560220374336411461772411702666554424421193101769766866425031904228432899084328109382386033140878217618407448151385536306356457975091999005435176331707792550355847678919185649003980612844127464953441948908653658626757079065602042234831459018617928015340713579893643269926553210324578896472679579143057499255651721081978203990842068950170363945528154181566893322027199540013868476424101983764560669826897372110032444263049853473999581274393509429702030074534259774441912514321429954486641764862389912165634753298503496987274297021603826373855299489665332980045626042070395302489206897376828872831681309460233198673717948526193173815998486243236940990054151299552963671083743133131320086142491994920076339753542242262159093060008717407830801449149246407429054060057869231925190215381637354397581702813299581595268958331206116587059631052398444368230084487200750858802408028362493080958863203350540104302885439820929652846810822012268159368936948783149742490267564849458269875764387284022479018545533708000475094136029739980611391149404998948850020574720276367581532096367245450111438861314016502251771626619770617482196040684241051229719638955848258711601449230431864642738016264616230947661977546921165614303336920594873047129309514963615057037955588709850041079865923722198085036156637475793278800587341968483510391600602017902571012696459982918204357935377381473615091532577811728590623970443827786656457202024947738949491050434479640309061643647354339446987086176829031794081709808641497939028951694979450772527950272653789549189971594471857296136989363428018479885550817503819909144866009873515648871527470089667117218970465504135840326783375492476724744637849602929995407405307200026828342697248300093649018698176608493732874265392514404262371752333888107561805388511227497667587557858216793416669121295999876380041411848421443009409598069284795805315649519636349094626799058059942233564734694322979510381089501783149257954775477023435267078094581178106163061749099650274125909364625366872670455272038421461889905163683639604619158296889325942133250572297473026399636420841343337282032910249489036914866216766306242746086617160783603260669828666764435495974703619964536047254724730591094280669421719280473782354957913365214181469812017021835874595030465977503896553607168170561453978564245013410219025191747460561722957552496171653955970861351116645053443355424088047260644609728255333649840992771523160167508544037518309121889943427982452859468270570716001999480469941211598166013334561097000740254837141359183281132981187173003018007907909084911534754016624659280687015006765916504752568366296745566161382550432878374711432860784006448579385752658478330108911715416587381980042411441736147879033756959899559967278828335729354948891349957093813441062886451717319282051073285430699786813324786910033950981485068506291236103005510413799745737938771620843753527896693275958193843005217248433029017905892371468821164355559298391566587285882803155556329668836395442377139281823916767305350368312012320720545103679686695403688633102445850860912200011106419036420168218686675505880007154586289426045638467535055657733195385749567833117323728527949370364538683091253891942661535063266940844527310380742163037454132151629920196049269431333414952710111030436049223732010382065130643059659584756326701909820785002538974738852620988773021343666913185983024145754783451177014049057728513234967982558429577216'
        , '598885496387336159215158337179296643572869874198415438721517031956294391267467138052833975210822790379645435252765184809790907879059390832431456890763826317589211758237474574018159857925570634144282954314842906400063553663884242875986410271598361502228854072762831378553289935007636618509623086614399709248699419865215841100064058520556986140758791562598688902501114759998860081837041267261910926840834156939147901883683592934604445887790093281004039491643639906988228730211742465708290649815465091229137126198956630386416170359815427838179479070235472610399015035810959640653610781106772716202393062410044423415928785961279533870544231701973513163229825784566847945851733257855753088163409148988722084210091625175105625266415505647159128966267046695766062982729521155903897799050637426474617110612526598459278585486968447249024042786308910850051017106038889061687767151283091964070893823182959298891383459811079403729066740772169275606698939480096480948919175320023826313542796993224153325663400369376016129480939312138469723199723534110595657777687480880412793207072338171511658351904166668048242956453135022989001809464768832188595267188382036606053289907501689359295334416673910623695996312840110689651484585283440480471698222497719355503194168560950281935485655294739301609663777113373659535718967303547951623526956338396985018174631435834656785781957446464286463809460246212247286223440883955123461676820718682834656934175017941968544782841849057554072567204274097863751252547881116514783088210584399664096224612954055771939895263749729051585416405834890522726931499793407634795102451963136189675604110386882667666700202021296939123142592598861407877348129582919695159135624222759532153769870798883632159023890309632619900847829779211195760910227705676555741607808745978228036024945439485997483773117861761846816143038325765449577516576845228775618794694822323427772717649125027086076998811187338852893643099277612863434755567049300968668608075953921793767085814197717905978584997781578440077423937447925873669288761103924157758615611230568564058097818416825907409237840644980565685003936400472616338363054823832113925515656141515345511440781430776107400081182066238156903296613221289208392191798325657897497026838673102803471094612120455368011519554557205053376663671919907929622429762923746679903431626862986005514917878931929165684488842314522696190750751104130758772492742171221506476388227098197462790072396811258045100484996907101399477804665561319641934728133590562936267652166532237603284227934840610439816138264438446708643682085053962432046459648769845201613113808872277523981275235642270948095440191476800941546005369324739646459243063300015084138888650243268999554932706194400103202052002256475547454921546756210434441774249495366559167821730580815611872299157633380987381812207714590674498242069538447774482969637038762378605688864932175145427786356322290946332387532834726569678238370085937344737751948866649747361373588969170028812987868238296955348481127935674306231597404181875425238311701462864830821158701402077328211001889853890086949823322215668362320216048221349456542834993635806413226788683589993095956742107311836481298366437924635728768234856559136863642247989697063646989127406234640433936180524078096916562215885382221221440174447087595474342702340083128927752717896538651110872000256594041548014611801466523195753961690032322786290650070510846917869315870454207312856770297593768844524696425727849441292728482259863151304805682511045957634104047520304681087570488096199426249870968715151352899262711414859028400306247511682097755259210044273287907069828213053162082804915911440204049504420189851777238231126675540195073124882510073151638213199509097027588754146115313488501895618592704144939889978242021363965347241635421115065464033561832225847238709861244250411633809994450569265409560194147735449585298329207794798511236425587495469494467899179662053326961034916517867933367808057191175385336962971973530250601332617559991043382608515546850921036964488304328204714534588455104569762031196764380573914497030120132291308170538348397837511623996297933672121009901941694829665518167940396094144081711936184081318439929556609569648834030333939030167533881530753927743675683048377118347128650493153271095307571548267716602161565111731981963404253792831860675668529002291340501102920781703654993775479142326056554305406934385461270207799502316565734128418269704729154185772068761081919140269479613439718429584336562493991766156958042518706487778614666958547617944366057917035046081816932122930397831885899367394704668767909522089490980411104133713860758251156103716971790705966662212818116148565527822567454545606791772821700331972738940950104057875162524624791534716722495993330597176066518166716680800409152545336552754751419653578617676888721974359792782967881648099394891147826325257661113821525698043547390457514434463473999530885287210000009489867014184718369266887805926383484231605051335786390632303781597551018628117508352980030059724480548533949284681845788829364189309471523884413954194859086869472657365044985433141123019472681576182090016085717562012755665853499189921886618259400375906348395090310900142148715431411955215491914127573351385908146653482483997520485329568230705228757993906938515288896844165579094197758186574987120643678489659211515541853732261407728812733452051953588927628461384781414660582371641376089400661867134510390162683271326617270588318894292606033372701978317622740978994527704380727470767368180702967071072288812051097001504045715988812189767358074825262336006037202238159764792224045818165003646975285929365924426658451465248929517024070447106402584830973235253084098352978893906920352652116340904008935681654751699242318452472319485281464039177405304692021677989652462657737972297496705447616703675014511838739629530737098712639069034012066077188936467469996574123242443286789792602919789894555982048116453916717116130063058668784438394777624864833158156184468926035001575570475329794750896833182478324073496576'
        , '3959613212817942196968287884854607138249695010687462454364841708851250756886730143010200497312491404781485112128545293038267410557687432146950851043426362765816215434907069232646845830697880715114498237144171635503366409257826346755285153686414093613591743288984395713590371609988997426858436873871662377222014131535012470582972340263924545236916165111578915024271639042423405991498025090677985246615888708814389494097187288049287415979235786510926548495671041495178109433955976169433598463074752794749833261671894416779587164022745726731816558059180128410052463097878416881346421940585665688499556244932031405619167193309877502125598274799692861848222186789839237161415950715076488613323777606157414531516260757170134150987782139353548730742670290744779603220618058769008513945985936788405184681857401721860333491468615517160265447106635779775116189694725965858433646555605352303369006895827491495266728584625923369382805582715543398299534252478300474804990013583056030504517708745604400254795470610884055712298069745897434773516459162650061100638644799141135564026144547699549924290389689515702725711923690519702231947789561422688360442715880502500729718659351717498594995066205790473119554476042449582563590579444721556498539231662047211644081609762161430568424342342242854439576719470899833805336316533137178302986916911543659790598077303875904224315053242517735730246856298337892312316528117634037166026440422177134130244659685698851719028656908543491242029580830020429397597945878491134064323290454637270114479800986458574381828790795066222590999367076594501777434267126916310434035574778547532869917547234512828881393561556657175848151136191220333591579083059191456438448403687051180171942755839609237451068823648275304071278515020701325144649797077281242875887293908713148087425084416129687389477450919839336384319643456353169764604635371056121820998845612577368007974752727989955080372815379334341844407691376688259658161238974567126603085075726800913322215326148218783626818232287223320959841024144071595668287525943886827137995088926789416420742895781629112626832021473618920626418326431458859284960751788990850345628853589391195089799880857621991457010020868383595460091757038998473321366148098536042605377671105942810444355441422008803094913405247372082842185535759207340245260120031482268289664155256889927160530153161598395632054016672558073391690755434186837560699746115376647075646124446313120539536864397378512528982338685436961057988195294019498594823503504893403210126005985201863912422945220587524487839774578151169639124967362823293256513202024803706423568550925173949161614257797912393511359242591869863619478797919472369000047141181208965931111421137288360760624748454875972501545483496405906288261654093770960025270251861037644320567270181065051970090049460704195505843123733155220934945908153070015156209041273961692602971492185076141511781001655030687032702373890902215036807381975613011048299714755167226115128307272101251476288442863767624217431718205364113124570399549481236095990457409373076315965718684534535322865287093771568758027809525357907282500979011293443231165575569445732992370476000920942922538926667095513699704161340592161159746236219773071356763754840639957122750858985185806119754237880099327946072326916962603744275213064634260928453104075010608297854587467237575467613798511046548517920545266623844188959929873419513930739752663887282896737602143712362102641121459357895275428584164006135336277168927794561201868749212479904416098658145097189359149052467301494653771651765986740908064319954228532907359916469374457144363856976480527707515526676064592447766901755037113256345750431361771536700237369409228138098929435715361717105374968249666768874716435458200086730293793319001160279518097064968936679995306918201968957611690366686286176964386475078710733881610365681670783276733231189516158495404203758005340538520187971152745328446019029100477501136956786385655556910835844321697477173648683328687159029719670236620302879815424433038397696239748990986244362183429736060133537688767006408936924928832453938314048346985862079684109578836282050219667623205694961246466059800792378418863583553057111154634775615626877637572769606110362768130814746824813196424289379204437786177275989321295838925014870509289623514139031100726371141651614681759490693712759141745584399038806017019558016549316152380251283298159184556076419304690117554103795728169472045336685854608739179828126567603445118239120699047381406429484442798343983663772265584848128132389264433157905449690280520607189331645267901161622386987161693221619602785888171129338673595852827689093839707616062594377604840077015747288019189892043058477610088173932710132968306471813414899036286602298340723365613904239299983917104952795547250211759660947922790165051457907929340870440808147913806352433854516953162243223960155861517020505099646669991472038855323639652044194991473889260921390120261070269987629039025773816966793417585417122418599005880133843186348612916355868235875600906126702646688542306262184400426360242713095741516009443419776144343751414966901561389451915222341230446882811797103693651699066520715449528551184687804313384261458874649260709607073211038923829085522743537368449086435360105601379194853966106312934064278617268327046200022923910857473355560421960130292197229185669933476428166642771389528948327200871438484659718235903183972267526825777356633446483538626285143021212714440333388352004712871330413326013160289574383811033720860915757855552976096653360492054042681357248970182573621851163508326287628494591608099752379466269094909310662446283468714450702831071516608374697328651174027719486158467818669370866178096050879261993434167401298795985980707851123427900202340473958560450518585690111010553544771878460143855957897625860681757637110872011856062933099161018703113954043675184893355122174208255701575495043843977938871685082192922187720143207515798671187372505602843788344758500881234814579017069183547924250517037035205307303196533903103753462639048730900319270404200704747783372674233117363014608397115419207799450124137593286730107373233455619658143491195747254705698916589686716679282080947654819934175511108443756527314614392729337477755314615118341084990438815138836433800030341206135764693071159103512059488720937401309490936269796380778420747225153504370370779582878038454534715791401735105081399755601073803578039237439792052053490239583704450989419267388307026202215022125780896032731025741953389880626859531073411113775249989905677420885901013463986839439831074089587489357533219454039264412034803623183594322135894548339913390308331649495108148299631153809459746028790153181652286533316810217288835890967080578311471722124410314477370827358400434067739029355888063072530341428376185805388255702691086336'
        , '931144559095633232126208229355238422113850001463928526808806653402284611978749773848642502745750235886919222407060185428231306967732769619297281980013350268777824022423404756395906567785248155561826937944274833923740390738824148161290823737958049820530398382439492832706492858419464598676976671688576142502366891340675317316068681637697880248732846321904750966833997786001310309120200658282221257336135929549036550061744409632977209462990688392010483186577025080300505439154842173051698566164323597521225148982722159154848051890417225579119019977474646952420072055433453392979599830638030975858156817574776780857341603739955310186275693823208522361746650294135982762631493630260440296242118468111690424024695941774984622208982218618787780694924886218778595539018846269180783840820529157483442192326809757233038818278544351098716756104360371402697649699164323488272794689303493004189224068600900181118538604424551652725042304722435816376266218433390388603467644466976804547146425331054951217184378808424332594083925155182832982159472615515341902108058720683125578959246931848261495828997178013596845354199917231980482567869955990167995854554369523190165573912977297180517149433490823604959047106378112471005314643822269585007087011538145234339976728853532157602057543904854629411274605932452870579488991136609732783784240829791448744610083328129267239508122032214799670476779843822277970343325829695026816171414545909246304506930111866504135926405519019485655865133813526497856795284293716128205000594291097962910935411393815561583572518472526153732001163761279287251157701495751404054444689143593271181671602022147407445873060064270454341879102067171675018670710714987235637425866272941497627166081868801157360822250810027481889585013016212899852611785157751883076569980821005079969072926332554680153173203338895070032638658125840653573916883039399935205543633951745787466690148089826117117657243257831657490663938781351381116227572241303232981886250802697969239959292657608118217229209868159447930961381937884588700550406298008045498293126305784409533501560556090108578930955711133879336299254332440191128196520251089959813244850562833458669019574381336018553192547527343317574562714945709282767542782834028937942861974148687366349450158945232645655529909220798953989715911622989782045344361002309344806739336182244938807418669931703683027377130379084982853098491659259855158405090971105251458954586624908411643177901332132814809468112362687318141930579642820018914283045529654443063613539101426483305748985917507581455754515369023026743836247852886535453326728082133293522658642331299935796928130018030818480422677538838956965601212138419154504967380526838935143775254906586599197415240575166801220910819705656742197761039950106686690504779097552831986565102429725804173266014453685290093114526437292440433960407175657685239915448099815850006730551255316627302862473641786008563606524605856693636013521258486299931348131511348406427540000225321607508389698318653719703860084453081285512996165699980676629804843537956663791253691330505074156414151320627989060040000179137136101782284956220042393073773213059204000566325536754294942468703966475952502877230496251160230446734493623723583120643305322843080431596659694553074795834727587261348452761015593999698133378994147496753076572214545249782028809681236010544352042918173982949324045843213997500927747289206255344505998813223363642439670241693488614984891331249010095994349944716123699267807724265007800163927104447490846345745949793759867901511944664572141882770787332308892319710394555706353736788900616352398568174198209109851841035446175481815157168443566194952287646095582408991213117937155107996775981980408528970628895197912029371688886349466383341466845939920071587708899546725111932158136397260332482343898814170739226439579850193142206959785448094168749960987350969632746340539747621176639385390914364875988478383944443359214440140902774834231916430993589280322176500958811116810247681936245520297425538031923074282967992614836681385929972546222335925060234676206978067676890857594910151246926089454427102994337686657605459558034155226706786813285016447366735703175320197499956300746056046025223803945221000309623868131688157661431915379851843326247774988476781849670899247695476647289863894085661155646760184301642424778879265758120778052963325596750282735202259067839282546552122284318569321373166030338881595799900424527448286933683599831931697521936312912186779550013236563233357017656167902265204723932072407915437555841001651929656271896225468035432161624208383013288008176043752445489964561523824301518519589295060026337804737645546962822214476355386509435728553369449179154910838189392696799279828498200356495478656067045604231857599722587667905660006500704018219509458973117938900141103236945291639167579196843196491081624912480118833206573562435500796465801433325491148403338625389895171161620423239959958028576907979260625288510598304246063276100557664043037019646077655342110517465058058795315235754472729840224279105469929954865835973189577796001999607794313526433694462036570650431188191095943686626899813538516152201255109484858519776280255840315096974446197470078870139104310156576796085569535530444764892922528705542824326882343868748685737882562018708983899422574630100067754165868793580710053909215444365946463095569689379848510581543040740385238615369362912814417863410613343685695921514222546585751447873232477185120031331124425336600155149234468119499588081480046942630182154398154100290513491341501279670005704427624997845301255410888008631271778703291991671676072348900511543898473421512234883777985447514247030459817249264809321336777566203485140278429462979723457867098434006175387723749320607209331551423558236391128098154843251759636346798267183062146430491937244685381750958728334948222216825688745617529096278658251271936077514062764766396784323111987521932860198805005593967248711774812535999967653213860730899151881047096921500545532706600825273588899006473066729110197662897119865915989570612538923014109557129410747734118494982081343812268567653146808857906672946006002047955736893123822251642500374931860091336637778294429299964598430473348422309965502604481402629942056019613146053399027000684239514840525205181325118182106162763966758912791816742521921672780852147090642256925388789393744308634543261238689762110771389722167845575748732590629180364896316949155971181662724428860305506839049769694051474503692860332811132673250835067159115434172543541550179457364857476422333499876547261156046952577604650762452910572665984710654777112390243286525513430539790948088946878283900276715395882464342636874485581596029563902413241866827648084857821540942490539559960754896869324211084713518100137037746424318025500509727748178870478328058303473643692954421197226299278408882009554014193872269524265646083629260691324693030276253363801051047696248540081844639379543524625752165198099483302601974027253958017067691799039549414194757517547200170457875303358509036719640018006002882274214700409756219860351866595160517010152297965751373553512459142590184813989792767713317335692994611825002730112262836830960036679665676980152636930481081790714009078235715276501439365863373061932594679503332457414460860816859522814089000110794296203262297437466957020110058161359038633951548053525522128505696419748930295629946033753061381308922833974781646054765703108598344622439265279334313666419202564908209099426821516744797183226491888898283758180245531699540890747352798058165118264772970753358612331049981847676238430745896174595759416037463684266670488554617360079433927593145407300154913845131713644045496907904546558342023012518908166333573154503183198780499993463478011954436879279858220657031419507256566228389546946647506901312402374220779318214233395890450617215253186546048075354077095767527130545470868316702154561131280878917303331290092362287932195995086762813942988338872619529634931584985374953173523111299932681633042076306818564338219024926945217147837886148189607497231993645666468756197920434375977508094402017263819578398097544923345282134032726672459240329724622873155001654584109366897100258573981354226915312707211637029583435523073887719388235822521973991211888125074628735012342305044429597332597213200409974705846370720637183286264731281965906825541778108552940108296728437448234144747146139338620028480233484930048861823085542463506338441437575643009897463416330649339568818663783446319496653729042595238658137960756432228513320218091001004745891335102561240390413324427084452455423397218879456675399221636077770282548422090980856831062969004310617009873788662440643487294339934475841761423064584833841167196530745088098089036504100975671332805186035802031768297142581474100864708292760282499057279066135166344088523700033335380763004143297714490622599140435602929530197196405773017566354273327991669667569538195578486686068341676311315038362764996385179103397970959991857011531983127760228694099660060696987967294331330736706919888636678963672397074058124865622392128920906432406771139134645845977728916839813106511057294966584582879030626854572141015492101340264210380297788949266366763908409732717702137484038056286739528111908126352875347417711188160759367876060415094940290515895415198587912513601365236667687221495917803958693029385516864361981358949770163207875477258682372183825302554330561722507351780057808777840322993164583302822143351811856524748832439568318834582926640907172513105422830232026136387371665450431213084477843169628403559438547443017189272409599049580339283613649369932465498219335506378270808498759945952623169148849532726791601420223143549255393150487570606581585973326498812394040394271014768629353869691485030246481598336980417241371746191667265029779076459577293462675387187640073986052094595012589069758978893187512073267107352788457200061845897861250190451480187846396768701887506814620983663918236980908975252584930232264069657472600593806867760449272325385158741138941453919448973985822672072973873712258800813742549368227040067108727912290470595398980846924900136645501936856572152665651502849751290524706924096126749146770951596654782642968239808046373354424687312841527337193051165248596605716686596044688347209545125465648324969433521859060549783001432771609378947915856490722909660930852740527224361850263324870097880146517617751012628135015932143424256001683749152150221432920968344081096825556243143357866787649583514513316905600307145891341981167510647221537790348081879692328912528074229419324673738343093081590187047190449465895594284023081816323108484480160595473513456520802847417352111481405898094746295906608191106702491810255511568477618934098333683120305508595255373082832947270584922765961935336474850769512727421388450209291783550957615844887613269669406697184137244624108061523595474537549401913436829063220889518888664742856813458980123186719613682303318436490078491227228988672430164581341877045898658271874990115268147710152843393502552723858003832015574627417330843207458990411487456330947464959143055503950422712401468722273943010722743470173829210489365706192936575013291888002434341513106481428084410218067776302464583926173850859700677942426264959992011707421213388034181456663546921703516072765792240543247119554578018326667051711735868531938994194235254484252101997594564032802761609063853910556063300517135898889778303004801040383499255602035711676712409123070651307968216379263517679580731162201116943266951391489405905466126440918380191449595583338132162026012052564867744233464653772653383861392634753585741688801525302207514716521501132103389833566878611447566787092048482471271030493737888238127054515332372608243140383344255126027921230462140200034876362987089465269431051533003585074124058613217593018664914883439502592893720931662651946350727983573191101710254076422054078660592193264714148948752944517154861642074033834860228570396665501570205083724872812398796201094386773670614901176864646233356987469041857789295767653848581870463515295024728954405255715515568044393547046567373353698121277710594358244434790271942656'
    ];
    private $array_factorial             = [
        '1',
        '1',
        '2',
        '6',
        '24',
        '120',
        '720',
        '5040',
        '40320',
        '362880',
        '3628800',
        '39916800',
        '479001600',
        '6227020800',
        '87178291200',
        '1307674368000',
        '20922789888000',
        '355687428096000',
        '6402373705728000',
        '121645100408832000',
        '2432902008176640000',
        '51090942171709440000',
        '1124000727777607680000',
        '25852016738884976640000',
        '620448401733239439360000',
        '15511210043330985984000000',
        '403291461126605635584000000',
        '10888869450418352160768000000',
        '304888344611713860501504000000',
        '8841761993739701954543616000000',
        '265252859812191058636308480000000',
        '8222838654177922817725562880000000',
        '263130836933693530167218012160000000',
        '8683317618811886495518194401280000000',
        '295232799039604140847618609643520000000',
        '10333147966386144929666651337523200000000',
        '371993326789901217467999448150835200000000',
        '13763753091226345046315979581580902400000000',
        '523022617466601111760007224100074291200000000',
        '20397882081197443358640281739902897356800000000',
        '815915283247897734345611269596115894272000000000',
        '33452526613163807108170062053440751665152000000000',
        '1405006117752879898543142606244511569936384000000000',
        '60415263063373835637355132068513997507264512000000000',
        '2658271574788448768043625811014615890319638528000000000',
        '119622220865480194561963161495657715064383733760000000000',
        '5502622159812088949850305428800254892961651752960000000000',
        '258623241511168180642964355153611979969197632389120000000000',
        '12413915592536072670862289047373375038521486354677760000000000',
        '608281864034267560872252163321295376887552831379210240000000000',
        '30414093201713378043612608166064768844377641568960512000000000000',
        '1551118753287382280224243016469303211063259720016986112000000000000',
        '80658175170943878571660636856403766975289505440883277824000000000000',
        '4274883284060025564298013753389399649690343788366813724672000000000000',
        '230843697339241380472092742683027581083278564571807941132288000000000000',
        '12696403353658275925965100847566516959580321051449436762275840000000000000',
        '710998587804863451854045647463724949736497978881168458687447040000000000000',
        '40526919504877216755680601905432322134980384796226602145184481280000000000000',
        '2350561331282878571829474910515074683828862318181142924420699914240000000000000',
        '138683118545689835737939019720389406345902876772687432540821294940160000000000000',
        '8320987112741390144276341183223364380754172606361245952449277696409600000000000000',
        '507580213877224798800856812176625227226004528988036003099405939480985600000000000000',
        '31469973260387937525653122354950764088012280797258232192163168247821107200000000000000',
        '1982608315404440064116146708361898137544773690227268628106279599612729753600000000000000',
        '126886932185884164103433389335161480802865516174545192198801894375214704230400000000000000',
        '8247650592082470666723170306785496252186258551345437492922123134388955774976000000000000000',
        '544344939077443064003729240247842752644293064388798874532860126869671081148416000000000000000',
        '36471110918188685288249859096605464427167635314049524593701628500267962436943872000000000000000',
        '2480035542436830599600990418569171581047399201355367672371710738018221445712183296000000000000000',
        '171122452428141311372468338881272839092270544893520369393648040923257279754140647424000000000000000',
        '11978571669969891796072783721689098736458938142546425857555362864628009582789845319680000000000000000',
        '850478588567862317521167644239926010288584608120796235886430763388588680378079017697280000000000000000',
        '61234458376886086861524070385274672740778091784697328983823014963978384987221689274204160000000000000000',
        '4470115461512684340891257138125051110076800700282905015819080092370422104067183317016903680000000000000000',
        '330788544151938641225953028221253782145683251820934971170611926835411235700971565459250872320000000000000000',
        '24809140811395398091946477116594033660926243886570122837795894512655842677572867409443815424000000000000000000',
        '1885494701666050254987932260861146558230394535379329335672487982961844043495537923117729972224000000000000000000',
        '145183092028285869634070784086308284983740379224208358846781574688061991349156420080065207861248000000000000000000',
        '11324281178206297831457521158732046228731749579488251990048962825668835325234200766245086213177344000000000000000000',
        '894618213078297528685144171539831652069808216779571907213868063227837990693501860533361810841010176000000000000000000',
        '71569457046263802294811533723186532165584657342365752577109445058227039255480148842668944867280814080000000000000000000',
        '5797126020747367985879734231578109105412357244731625958745865049716390179693892056256184534249745940480000000000000000000',
        '475364333701284174842138206989404946643813294067993328617160934076743994734899148613007131808479167119360000000000000000000',
        '39455239697206586511897471180120610571436503407643446275224357528369751562996629334879591940103770870906880000000000000000000',
        '3314240134565353266999387579130131288000666286242049487118846032383059131291716864129885722968716753156177920000000000000000000',
        '281710411438055027694947944226061159480056634330574206405101912752560026159795933451040286452340924018275123200000000000000000000',
        '24227095383672732381765523203441259715284870552429381750838764496720162249742450276789464634901319465571660595200000000000000000000',
        '2107757298379527717213600518699389595229783738061356212322972511214654115727593174080683423236414793504734471782400000000000000000000',
        '185482642257398439114796845645546284380220968949399346684421580986889562184028199319100141244804501828416633516851200000000000000000000',
        '16507955160908461081216919262453619309839666236496541854913520707833171034378509739399912570787600662729080382999756800000000000000000000',
        '1485715964481761497309522733620825737885569961284688766942216863704985393094065876545992131370884059645617234469978112000000000000000000000',
        '135200152767840296255166568759495142147586866476906677791741734597153670771559994765685283954750449427751168336768008192000000000000000000000',
        '12438414054641307255475324325873553077577991715875414356840239582938137710983519518443046123837041347353107486982656753664000000000000000000000',
        '1156772507081641574759205162306240436214753229576413535186142281213246807121467315215203289516844845303838996289387078090752000000000000000000000',
        '108736615665674308027365285256786601004186803580182872307497374434045199869417927630229109214583415458560865651202385340530688000000000000000000000',
        '10329978488239059262599702099394727095397746340117372869212250571234293987594703124871765375385424468563282236864226607350415360000000000000000000000',
        '991677934870949689209571401541893801158183648651267795444376054838492222809091499987689476037000748982075094738965754305639874560000000000000000000000',
        '96192759682482119853328425949563698712343813919172976158104477319333745612481875498805879175589072651261284189679678167647067832320000000000000000000000',
        '9426890448883247745626185743057242473809693764078951663494238777294707070023223798882976159207729119823605850588608460429412647567360000000000000000000000',
        '933262154439441526816992388562667004907159682643816214685929638952175999932299156089414639761565182862536979208272237582511852109168640000000000000000000000',
        '93326215443944152681699238856266700490715968264381621468592963895217599993229915608941463976156518286253697920827223758251185210916864000000000000000000000000',
        '9425947759838359420851623124482936749562312794702543768327889353416977599316221476503087861591808346911623490003549599583369706302603264000000000000000000000000',
        '961446671503512660926865558697259548455355905059659464369444714048531715130254590603314961882364451384985595980362059157503710042865532928000000000000000000000000',
        '99029007164861804075467152545817733490901658221144924830052805546998766658416222832141441073883538492653516385977292093222882134415149891584000000000000000000000000',
        '10299016745145627623848583864765044283053772454999072182325491776887871732475287174542709871683888003235965704141638377695179741979175588724736000000000000000000000000',
        '1081396758240290900504101305800329649720646107774902579144176636573226531909905153326984536526808240339776398934872029657993872907813436816097280000000000000000000000000',
        '114628056373470835453434738414834942870388487424139673389282723476762012382449946252660360871841673476016298287096435143747350528228224302506311680000000000000000000000000',
        '12265202031961379393517517010387338887131568154382945052653251412013535324922144249034658613287059061933743916719318560380966506520420000368175349760000000000000000000000000',
        '1324641819451828974499891837121832599810209360673358065686551152497461815091591578895743130235002378688844343005686404521144382704205360039762937774080000000000000000000000000',
        '144385958320249358220488210246279753379312820313396029159834075622223337844983482099636001195615259277084033387619818092804737714758384244334160217374720000000000000000000000000',
        '15882455415227429404253703127090772871724410234473563207581748318444567162948183030959960131517678520479243672638179990208521148623422266876757623911219200000000000000000000000000'
    ];

    private function prob_prime($num)
    {
        if ($num == 2 OR $num == 3) {
            return true;
        }

        $numToCheck = explode('-', chunk_split($num.'.00000000', 1, '-'));
        $divideBy   = 9; //currently only for dividing by 9!

        $setting['decimals only'] = true;

        $answer  = []; // to hold the answer
        $working = false; // for working out

        foreach ($numToCheck as $nthDigit => $digit) {
            if ($digit == '.') {
                $donePoint = true;
                $answer[]  = '.';
            } else {
                if ($working != false) {
                    $working = $digit + ($working * 10);
                    if ($working > $divideBy) {
                        $temp = ($working % $divideBy);
                        if ($donePoint == true) {
                            $answer[$nthDigit - 1] = ($working - $temp) / $divideBy;
                        }
                        if ($temp == 0) {
                            $working = false;
                        } else {
                            $working = $temp;
                        }
                    }
                } elseif ($digit > $divideBy) {
                    $temp = ($digit % $divideBy);
                    if ($donePoint == true) {
                        $answer[$nthDigit - 1] = $digit - $temp;
                    }
                } else {
                    $working = $digit;
                }
            }
        }

        $answer = implode('', $answer);
        $answer = trim($answer, '.');
        $answer = substr($answer, 0, 5);
        if ($answer == '11111' OR $answer == '22222' OR $answer == '44444' OR $answer
            == '55555' OR $answer == '77777' OR $answer == '88888') {
            return true;
        } else {
            return false;
        }
    }

    //convert a decimal/denery number to a base of your choosing (max = base 16)
    private function dec2base($n, $base)
    {
        $values = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C',
            'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q',
            'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 'a', 'b', 'c', 'd', 'e',
            'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's',
            't', 'u', 'v', 'w', 'x', 'y', 'z', '+', '/'];
        $val    = '';
        while (($n != '0') && ($n != 0)) {
            $val = $values[bcmod($n, $base)].$val;
            $n   = bcdiv($n, $base, 0);
        }
        return $val;
    }

    private function dec2bab($n)//decimal to babylonian numerals (base 60)
    {
        $values = [' &nbsp; &nbsp; &nbsp; '];
        for ($i = 1; $i < 60; $i++) {
            $values[] = '<img src="//static.bigprimes.net/imgs/babnumbers/bab_'.$i.'.gif" alt="'.$i.'">';
        }
        $val = '';
        while (($n != '0') && ($n != 0)) {
            $val = $values[bcmod($n, 60)]." &nbsp; ".$val;
            $n   = bcdiv($n, 60, 0);
        }
        return $val;
    }

    private function is_even($n)
    {
        switch (substr($n, -1)) {
            case '0':
            case '2':
            case '4':
            case '6':
            case '8':
                return true;
            default:
                return false;
        }
    }

    //check if a number is a triangle number or not. if not then return false.
    //if true return which triangle number it is
    private function is_triangle($num)
    {
        $n           = 2;
        $n_too_small = 1;
        $n_too_big   = $num;
        $j           = 0;
        while (!(((($n * ($n + 1)) / 2) < $num) AND ( $num < ((($n - 1) * $n) / 2)))) {
            $formula = (($n * ($n + 1)) / 2);
            if ($formula < $num) { //if its too small
                if ((($n + 1 * ($n + 2)) / 2) > $num) {
                    return false;
                }
                $n_too_small = $n;
                $n           = round(abs(mt_rand($n_too_small, $n_too_big)), 0);
            } elseif ($formula > $num) { //if its too big
                if (((($n - 1) * $n) / 2) < $num) {
                    return false;
                }
                $n_too_big = $n;
                $n         = round(abs(mt_rand($n_too_small, $n_too_big)), 0);
            } else { // its a triangle number!!!
                return $n;
            }
        }
        return false;
    }

    private function is_perfect($n, $array_perfects)
    {
        //if the number is found in the fermat array then this function returns which term it is
        //e.g. 496 is the 3rd term
        $last_digit = substr($n, -1);
        //check to make sure that the number ends in 6 or 8 because all perfect numbers end in 6 or 8

        switch ($last_digit) {
            case '6':
            case '8':
                $pos = array_search($n, $array_perfects);
                return $pos !== false ? $pos + 1 : false;
            break;
            default:
                return false;
            break;
        }       
    }

    private function is_prime($n, $database)
    {
        //this function return true or false if a number is prime or not
        if ($n == 2 OR $n == 3) {
            return true;
        }

        if (bcmod($n, 2) == 0) {
            return false;
        }
        if (bcmod($n, 3) == 0) {
            return false;
        }

        //check the serious way
        $sqrt = ceil(bcsqrt($n)) + 1;
        $j    = 2;
        for ($i = 5; $i < $sqrt; $i += $j, $j = 6 - $j) {
            if (bcmod($n, $i) == 0) {
                return false;
            }
        }
        //else it must be prime
        //add to database as a cache
        $this->app['dbs']['mysql_write']->insert('numberCache', array(
                    'number' => $n,
                    'is_prime' => 1
        ));
        return true;
    }

    private function is_palindrome($number)
    {
        $len = strlen($number);
        if (is_int($len / 2) == true) {
            $i = 1;
            while ($i <= $len / 2) {
                if (substr($number, ($i - 1), 1) != substr($number, -$i, 1)) {
                    return false;
                }
                $i++;
            }
        } else {
            $i = 1;
            while ($i <= ($len / 2)) {
                if (substr($number, ($i - 1), 1) != substr($number, -$i, 1)) {
                    return false;
                }
                $i++;
            }
        }
        return true;
    }

    private function factors($n)
    {
        //check cache
        $sql = 'SELECT factors FROM numberCache WHERE number = ? LIMIT 1';
        $factors = $this->app['dbs']['mysql_read']->fetchAssoc($sql, array($n));
        if ($factors != false) {
            $factors = str_replace(',', '<br />', $factors['factors']);
            return $factors;
        }

        //heavy calculation due to cache miss
        $afactors = null;
        exec('/srv/api.bigprimes.net/public/bin/factors '.(int) $n, $afactors);

        //update cache
        $insertString = implode($afactors, ',');
        if ($cacheCheck == 1) {
            $sql = "UPDATE numberCache SET factors = ?  WHERE number = ?";
            $this->app['dbs']['mysql_write']->executeUpdate($sql, array($insertString, $n));
        } else {
            $this->app['dbs']['mysql_write']->insert('numberCache', array(
                    'number' => $n,
                    'factors' => $insertString
            ));
        }

        return implode($afactors, '<br />');
    }
    
    private $ones = [
 '',
 ' one',
 ' two',
 ' three',
 ' four',
 ' five',
 ' six',
 ' seven',
 ' eight',
 ' nine',
 ' ten',
 ' eleven',
 ' twelve',
 ' thirteen',
 ' fourteen',
 ' fifteen',
 ' sixteen',
 ' seventeen',
 ' eighteen',
 ' nineteen'
];

private $tens = [
 '',
 '',
 ' twenty',
 ' thirty',
 ' forty',
 ' fifty',
 ' sixty',
 ' seventy',
 ' eighty',
 ' ninety'
];

private $triplets = [
 '',
 ' thousand',
 ' million',
 ' billion',
 ' trillion',
 ' quadrillion',
 ' quintillion',
 ' sextillion',
 ' septillion',
 ' octillion',
 ' nonillion'
];


    private $numeralsRoman    = [
            ['I', 'II', 'III', 'IV', 'V', 'VI', 'VII', 'VIII', 'IX',
            'X'], //units
        ['X', 'XX', 'XXX', 'XL', 'L', 'LX', 'LXX', 'LXXX', 'XC',
            'C'], //tens
        ['C', 'CC', 'CCC', 'CD', 'D', 'DC', 'DCC', 'DCCC', 'CM',
            'M'], //hundreds
        ['M', 'MM', 'MMM', "M<span class='u'>V</span>", "<span class='u'>V</span>",
            "<span class='u'>V</span>M", "<span class='u'>V</span>MM", "<span class='u'>V</span>MMM",
            "M<span class='u'>X</span>", "<span class='u'>X</span>"], //THOUSANDS
        ["<span class='u'>X</span>", "<span class='u'>X</span><span class='u'>X</span>",
            "<span class='u'>X</span><span class='u'>X</span><span class='u'>X</span>",
            "<span class='u'>X</span><span class='u'>L</span>", "<span class='u'>L</span>",
            "<span class='u'>L</span><span class='u'>X</span>", "<span class='u'>L</span><span class='u'>X</span><span class='u'>X</span>",
            "<span class='u'>L</span><span class='u'>X</span><span class='u'>X</span><span class='u'>X</span>",
            "<span class='u'>X</span><span class='u'>C</span>", "<span class='u'>C</span>"], //TEN THOUSANDS
        ["<span class='u'>C</span>", "<span class='u'>C</span><span class='u'>C</span>",
            "<span class='u'>C</span><span class='u'>C</span><span class='u'>C</span>",
            "<span class='u'>C</span><span class='u'>D</span>", "<span class='u'>D</span>",
            "<span class='u'>D</span><span class='u'>C</span>", "<span class='u'>D</span><span class='u'>C</span><span class='u'>C</span>",
            "<span class='u'>D</span><span class='u'>C</span><span class='u'>D</span><span class='u'>C</span>",
            "<span class='u'>C</span><span class='u'>M</span>", "<span class='u'>M</span>"] //HUNDRED THOUSANDS
    ];
    private $numeralsEgyptian = [
            ['&#x133fa;', '&#x133fb;', '&#x133fc;', '&#x133fd;', '&#x133fe;',
            '&#x133ff;', '&#x13400;', '&#x13401;', '&#x13402;'],
            ['&#x13386;', '&#x13387;', '&#x13388;', '&#x13389;', '&#x1338a;',
            '&#x1338b;', '&#x1338c;', '&#x1338d;', '&#x1338e;'],
            ['&#x13362;', '&#x13363;', '&#x13364;', '&#x13365;', '&#x13366;',
            '&#x13367;', '&#x13368;', '&#x13369;', '&#x1336a;'],
            ['&#x131bc;', '&#x131bd;', '&#x131be;', '&#x131bf;', '&#x131c0;',
            '&#x131c1;', '&#x131c2;', '&#x131c3;', '&#x131c4;'],
            ['&#x130ad;', '&#x130ae;', '&#x130af;', '&#x130b0;', '&#x130b1;',
            '&#x130b2;', '&#x130b3;', '&#x130b4;', '&#x130b5;'],
            ['&#x13190;', '&#x13190;&#x13190;', '&#x13190;&#x13190;&#x13190;',
            '&#x13190;&#x13190;&#x13190;&#x13190;', '&#x13190;&#x13190;&#x13190;&#x13190;&#x13190;',
            '&#x13190;&#x13190;&#x13190;&#x13190;&#x13190;&#x13190;', '&#x13190;&#x13190;&#x13190;&#x13190;&#x13190;&#x13190;&#x13190;',
            '&#x13190;&#x13190;&#x13190;&#x13190;&#x13190;&#x13190;&#x13190;&#x13190;',
            '&#x13190;&#x13190;&#x13190;&#x13190;&#x13190;&#x13190;&#x13190;&#x13190;&#x13190;'],
        ['&#x13068;', '&#x13068;&#x13068;', '&#x13068;&#x13068;&#x13068;',
            '&#x13068;&#x13068;&#x13068;&#x13068;', '&#x13068;&#x13068;&#x13068;&#x13068;&#x13068;',
            '&#x13068;&#x13068;&#x13068;&#x13068;&#x13068;&#x13068;', '&#x13068;&#x13068;&#x13068;&#x13068;&#x13068;&#x13068;&#x13068;',
            '&#x13068;&#x13068;&#x13068;&#x13068;&#x13068;&#x13068;&#x13068;&#x13068;',
            '&#x13068;&#x13068;&#x13068;&#x13068;&#x13068;&#x13068;&#x13068;&#x13068;&#x13068;&#x13068;']
    ];
    private $numeralsChinese  = [
            ["&#22777;", "&#36019;", "&#21444;", "&#32902;", "&#20237;",
            "&#38520;", "&#26578;", "&#25420;", "&#29590;"], //units
        ["&#22777;&#25342;", "&#36019;&#25342;", "&#21444;&#25342;",
            "&#32902;&#25342;", "&#20237;&#25342;", "&#38520;&#25342;", "&#26578;&#25342;",
            "&#25420;&#25342;", "&#29590;&#25342;"], //tens
        ["&#22777;&#20336;", "&#36019;&#20336;", "&#21444;&#20336;",
            "&#32902;&#20336;", "&#20237;&#20336;", "&#38520;&#20336;", "&#26578;&#20336;",
            "&#25420;&#20336;", "&#29590;&#20336;"], //hundreds
        ["&#22777;&#20191;", "&#36019;&#20191;", "&#21444;&#20191;",
            "&#32902;&#20191;", "&#20237;&#20191;", "&#38520;&#20191;", "&#26578;&#20191;",
            "&#25420;&#20191;", "&#29590;&#20191;"], //thousands
        ["&#22777;&#33836;", "&#36019;&#33836;", "&#21444;&#33836;",
            "&#32902;&#33836;", "&#20237;&#33836;", "&#38520;&#33836;", "&#26578;&#33836;",
            "&#25420;&#33836;", "&#29590;&#33836;"], //tenthousands
        ["&#22777;&#25342;&#33836;", "&#36019;&#25342;&#33836;", "&#21444;&#25342;&#33836;",
            "&#32902;&#25342;&#33836;", "&#20237;&#25342;&#33836;", "&#38520;&#25342;&#33836;",
            "&#26578;&#25342;&#33836;", "&#25420;&#25342;&#33836;", "&#29590;&#25342;&#33836;"] //hundred thousands
    ];

    private function den2numerals($n, $glyphs)
    {
        //this function converts a number in the form of a string
        //to egyptian/babylonian/chinese numerals

        $numerals = '';
        $length   = strlen($n);

        for ($i = 0; $i < $length; $i++) {
            $tmp = (substr($n, -($i + 1), 1) - 1);
            if (isset($glyphs[$i][$tmp])) {
                $numerals = $glyphs[$i][$tmp].$numerals;
            }
        }

        return $numerals;
    }

    private function convertNum($num, $ones, $tens, $triplets) {
      if (!bccomp($num,0)){//same as $num==0
          return 'zero';
      }

      return $this->convertTri($num, 0, $ones, $tens, $triplets);
    }

private  function convertTri($num, $tri, $ones, $tens, $triplets) {
  // chunk the number, ...rxyy
  //$r = (int) bcdiv($num,1000);
  $r = bcdiv($num,1000);

  $x = bcmod(bcdiv($num,100),10);
  $y = bcmod($num,100);

  // init the output string
  $str = '';

  // do hundreds
  if ($x > 0)
   $str = $ones[$x] . ' hundred';

  // do ones and tens
  if ($y < 20){
   $str .= $ones[$y];
  }else{
   $str .= $tens[(int) bcdiv($y,10)] . $ones[bcmod($y,10)];
  }
  // add triplet modifier only if there
  // is some output to be modified...
  if ($str != '' && isset($triplets[$tri])){
   $str .= $triplets[$tri];
  }

  // continue recursing?
  if ($r > 0){
   return $this->convertTri($r, bcadd($tri,1), $ones, $tens, $triplets).$str;
  }else{
   return $str;
  }
 }


    public function getContent($n)
    {
        $return = '<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
             style="display:inline-block;width:728px;height:90px"
             data-ad-client="ca-pub-9286138628337172"
             data-ad-slot="8513669215"></ins>
        <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script>';

        $number = $n;
        if (strlen($number) > 0) {

            $return .= "<div align='center'><table class=\"text\" width='75%' border='0' cellspacing='0' cellpadding='3'><tr><td align='left' class='text'><br />";

            //make sure there are no spaces, commas, charcater returns so line feeds in the number
            $number = str_replace([' ', ',', chr(13), chr(10)], '', $number);
            
            $is_number = ctype_digit($number);

            if ($is_number && $number !== '0') {
                $num_len   = strlen($number);
                $is_even   = $this->is_even($number);
              
                $return .= '<b>The number you submitted to be crunched was:</b>'.
                    '<h1>'.strrev(wordwrap(strrev($number), 3, ' ', 1)).' - '.$this->convertNum($number,
                        $this->ones, $this->tens, $this->triplets).'</h1>';

                $return .= "<table class=\"text\" width='100%' border='1' cellspacing='0' cellpadding='2'><tr><td>"; //begin table
                //odd or even?
                if ($is_even) {
                    $return .= 'It is an even number.<br />';
                } else {
                    $return .= 'It is an odd number.<br />';
                }
                //palindrome or not?
                if ($num_len > 1) { //if its got more than 1 digit
                    if ($this->is_palindrome($number)) {
                        $return .= 'It is a palindrome.<br />';
                    } else {
                        $return .= 'It is not a palindrome.<br />';
                    }
                }
                //prime ?
                $primes = new \Bigprimes\Primes($this->app);
                $is_prime = $primes->checkPrime($number);
                if ($is_prime === null) {
                    $return .= 'This number is not in our database (Therfore I\'m unable to check for primality).<br />';
                } elseif ($is_prime !== false) {
                    $return .= 'It is the '.$this->stndrd($is_prime).' prime number.<br />';
                } else {
                    $return .= 'It is not a prime number.<br />';
                }
                //mersenne prime or not?
                if ($num_len <= strlen(end($this->array_mersenne))) {
                    $mersenne = array_search($number, $this->array_mersenne);
                    if ($mersenne !== false) {
                        $return .= 'It is the '.$this->stndrd($mersenne+1)." <a href='http://en.wikipedia.org/wiki/Mersenne_prime' class='link'>mersenne prime</a> number.<br />";
                    } else {
                        $return .= "It is not a <a href='http://en.wikipedia.org/wiki/Mersenne_prime' class='link'>mersenne prime</a> number.<br />";
                    }
                } else {
                    $return .= 'Numbers larger than '.strlen(end($this->array_mersenne))." digits are not checked to see if they are a <a href='http://www.mersenne.org/' class='mlink' >mersenne prime</a>.<br />";
                }
                //fermat number or not?
                if ($num_len <= strlen(end($this->array_fermat))) {
                    $fermat = array_search($number, $this->array_fermat);
                    if ($fermat !== false) {
                        $return .= 'It is the '.$this->stndrd($fermat+1)." <a href='http://en.wikipedia.org/wiki/Fermat_number'>fermat number</a>.<br />";
                    } else {
                        $return .= "It is not a <a class=\"link\" href='http://en.wikipedia.org/wiki/Fermat_number'>fermat number</a>.<br />";
                    }
                } else {
                    $return .= 'Numbers larger than '.strlen(end($this->array_fermat))." digits are not checked to see if they are a fermat number.<br />";
                }
                //perfect number or not?
                if ($num_len <= strlen(end($this->array_perfect))) {
                    $perfect = $this->is_perfect($number, $this->array_perfect);
                    if ($perfect) {
                        $return .= 'It is the '.$this->stndrd($perfect)." <a href='http://en.wikipedia.org/wiki/Perfect_number' class='link'>perfect number</a>.<br />";
                    } else {
                        $return .= "It is not a <a href='http://en.wikipedia.org/wiki/Perfect_number' class='link'>perfect number</a>.<br />";
                    }
                } else {
                    $return .= 'Numbers larger than '.strlen(end($array_perfect))." digits are not checked to see if they are perfect.<br />";
                }

                $return .= '</td></tr></table><br /><br />'; //end table


                $return .= "<table class=\"text\" width='100%' border='1' cellspacing='0' cellpadding='2'><tr><td>"; //begin table
                //triangle number or not?
                if ($num_len <= $this->max_len_triangle) {
                    $triangle_num = $this->is_triangle($number);
                    if ($triangle_num) {
                        $return .= 'It is the '.$this->stndrd($triangle_num).' triangle number.<br />';
                    } else {
                        $return .= 'It is not a triangle number.<br />';
                    }
                } else {
                    $return .= 'Numbers larger than '.$this->max_len_triangle.' digits are not checked to see if they are triangle numbers.<br />';
                }

                //square number or not?
                if ($num_len <= $this->max_len_square) {
                    $sqrt = bcsqrt($number,9);
                    if (substr($sqrt, -10) === '.000000000') {
                        $return .= 'It is the '.$this->stndrd(number_format($sqrt, 0,
                                    '.', '')).' square number.<br />';
                    } else {
                        $return .= 'It is not a square number.<br />';
                    }
                } else {
                    $return .= 'Numbers larger than '.$this->max_len_square.' digits are not checked to see if they are square numbers.<br />';
                }

                //cube number or not?
                if ($num_len <= $this->max_len_cube) {
                    $cbrt = pow($number, (1 / 3));
                    if (!stristr($cbrt, '.')) {
                        $return .= 'It is the '.$this->stndrd(number_format($cbrt, 0,
                                    '.', '')).' cube number.<br />';
                    } else {
                        $return .= 'It is not a cube number.<br />';
                    }
                } else {
                    $return .= 'Numbers larger than '.$this->max_len_cube.' digits are not checked to see if they are cube numbers.<br />';
                }

                $return .= "<br />";
                //factorial number or not?
                if ($num_len <= strlen(end($this->array_factorial))) {
                    $factorial = array_search($number, $this->array_factorial);
                    if ($factorial !== false) {
                        $return .= "It is the ".$this->stndrd($factorial+1)." factorial number (".$factorial."!).<br />";
                    } else {
                        $return .= 'It is not a factorial number.<br />';
                    }
                } else {
                    $return .= 'Numbers larger than '.strlen(end($this->array_factorial))." digits are not checked to see if they are a factorial.<br />";
                }
                $return .= '</td></tr></table><br /><br />'; //end table

                $return .= "<table class=\"text\" width='100%' border='1' cellspacing='0' cellpadding='2'><tr><td>"; //begin table
                if ($is_prime == false) {
                    if ($num_len <= $this->max_len_factorization) {
                        if ($is_prime == false) {
                            $return .= 'It has the following factors:<br /><br />';
                            $return .= $this->factors($number);
                        } else {
                            $return .= 'It it has no factors except itself and 1.';
                        }
                    } else {
                        $return .= 'Numbers larger than '.$this->max_len_factorization.' digits are not factored.';
                    }
                } else {
                    $return .= 'It it has no factors except itself and 1.';
                }
                $return .= '</td></tr></table><br /><br />'; //end table

                $return .= "<table class=\"text\" width='100%' border='1' cellspacing='0' cellpadding='2'><tr><td>"; //begin table
                //converting to different bases
                if ($num_len <= $this->max_len_convertion) {
                    $return .= "<table class=\"text\" width='100%' border='0' cellspacing='0' cellpadding='2'>";
                    $return .= "<tr><td width='200'>Base 2 (Binary):</td><td>".strrev(wordwrap(strrev($this->dec2base($number,
                                        2)), 4, " ", 1))."</td></tr>";
                    $return .= "<tr><td>Base 3 (Ternary):</td><td>".strrev(wordwrap(strrev($this->dec2base($number,
                                        3)), 6, " ", 1))."</td></tr>";
                    $return .= "<tr><td>Base 4 (Quaternary):</td><td>".strrev(wordwrap(strrev($this->dec2base($number,
                                        4)), 4, " ", 1))."</td></tr>";
                    $return .= "<tr><td>Base 5 (Quintal):</td><td>".strrev(wordwrap(strrev($this->dec2base($number,
                                        5)), 5, " ", 1))."</td></tr>";
                    $return .= "<tr><td>Base 8 (Octal):</td><td>".strrev(wordwrap(strrev($this->dec2base($number,
                                        8)), 8, " ", 1))."</td></tr>";
                    $return .= "<tr><td>Base 10 (Denary):</td><td>".strrev(wordwrap(strrev($number),
                                3, " ", 1))."</td></tr>";
                    $return .= "<tr><td>Base 16 (Hexadecimal):</td><td>".strrev(wordwrap(strrev($this->dec2base($number,
                                        16)), 4, " ", 1))."</td></tr>";
                    $return .= '</table>';
                } else {
                    $return .= 'Numbers larger than '.$this->max_len_convertion.' digits in length are not converted to different bases.';
                }
                $return .= '</td></tr></table><br /><br />'; //end table
                //roman, egyptian, chinese and babylonian numerals
                if ($num_len <= $this->max_len_babylonian_numerals) {
                    $return .= "<table class=\"text\" width='100%' border='1' cellspacing='0' cellpadding='2'>"; //begin table
                    if ($num_len <= $this->max_len_roman_numerals) {
                        $return .= "<tr><td width='200'>Roman Numerals:</td><td>".$this->den2numerals($number,
                                $this->numeralsRoman)."</td></tr>";
                    }
                    if ($num_len <= $this->max_len_egypt_numerals) {
                        $return .= "<tr><td width='200'>Egyptian Numerals:</td><td style='font-size:40px;'>".$this->den2numerals($number,
                                $this->numeralsEgyptian)."</td></tr>";
                    }
                    if ($num_len <= $this->max_len_chinese_numerals) {
                        $return .= "<tr><td width='200'>Chinese Numerals:</td><td valign='middle' bgcolor='#FFFFFF'>".$this->den2numerals($number,
                                $this->numeralsChinese)."</td></tr>";
                    }
                    $return .= "<tr><td>Babylonian Numerals:</td><td valign='middle' bgcolor='#FFFFFF'>".$this->dec2bab($number)."</td></tr>";
                    $return .= '</table><br /><br />'; //end table
                }
            } else {
                $return .= '<b>\''.$number.'\' is not a positive integer.<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />';
            }
            $return .= '</td></tr></table></div>';
        } else {
            $return .= '<div align="center"><table width="75%" border="0" cellspacing="0" cellpadding="3"><tr><td align="left" class="text">
    <h1>Number Cruncher</h1>
	Welcome to the number cruncher.
	Type in a number in the box below and we will crunch it for you.<br /><br />
	You will be taken to a page that tells you the following information about your number:
    <ul>
	<li>Is it odd or even?</li>
	<li>Is it a palindrome?</li>
	<li>Is it a prime number? (Checks numbers upto '.$this->max_len_prime.' digits in length)</li>
	<li>Is it a <a class="link mlink" href="http://en.wikipedia.org/wiki/Mersenne_prime">mersenne prime</a>? (Checks numbers upto '.strlen(end($this->array_mersenne))." digits in length)</li>
	<li>Is it a <a class=\"link mlink\" href='http://www.fermatsearch.org/'>fermat prime</a>? (Checks numbers upto ".strlen(end($this->array_fermat))." digits in length)</li>
	<li>Is it a <a class=\"link mlink\" href='http://en.wikipedia.org/wiki/Perfect_number'>perfect number</a>? (Checks numbers upto ".strlen(end($this->array_perfect))." digits in length)</li>
	<li>Is it a triangle number? (Checks numbers upto ".$this->max_len_triangle." digits in length)</li>
	<li>Is it a square number? (Checks numbers upto ".$this->max_len_square." digits in length)</li>
	<li>Is it a cube number? (Checks numbers upto ".$this->max_len_cube." digits in length)</li>
	<li>Is it a factorial number? (Checks numbers upto ".strlen(end($this->array_factorial))." digits in length)<br /><br /></li>
	<li>All factors of the number will be listed (for numbers upto ".$this->max_len_factorization." digits)</li>
	<li>The page will also show a list of base conversions. e.g. binary, octal and hexadecimal (Numbers upto ".$this->max_len_convertion." digits in length)</li>
	<li>The number will be converted to roman numerals (Upto ".$this->max_len_roman_numerals." digits in length)</li>
	<li>The number will be converted to egyptian numerals (Upto ".$this->max_len_egypt_numerals." digits in length)</li>
	<li>The number will be converted to chinese numerals (Upto ".$this->max_len_chinese_numerals." digits in length)</li>
	<li>The number will be converted to babylonian numerals (Upto ".$this->max_len_babylonian_numerals." digits in length)</li>
    </ul>
	
	<br /><br />
	
	Please type your number here:
	<form name=\"crunchy\" action='/cruncher/' method='get' target='_top'>
	<table width='200' border='0' cellspacing='0' cellpadding='2'>
	  <tr>
		<td><textarea name='number' cols='85' rows='10' onkeydown=\"if (event.keyCode == 13){document.location='/cruncher/'+crunchy.number.value+'/'}\"></textarea></td>
	  </tr>
	  <tr>
		<td align='center'><input type='button' value='Crunch' onclick=\"document.location='/cruncher/'+crunchy.number.value+'/'\" /></td>
	  </tr>
	</table>
	</form>
	</td></tr></table></div>";
        }

        return $return;
    }
}
